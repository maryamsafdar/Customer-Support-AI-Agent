
# üí¨ Customer Support AI Agent  
**FastAPI + SQLite + Hugging Face Transformers + Streamlit**

A lightweight **AI-powered customer support system** that:
- Answers FAQs from a small local knowledge base  
- Uses a Hugging Face Q&A model for AI-driven responses  
- Creates tickets automatically when uncertain  
- Includes a simple REST API and optional Streamlit chat UI  

---

## üåê Live Demo

üñ• **Frontend (Streamlit App):** [https://customer-support-ai-agent-k4vwnntjzdtznlgtrhoyxs.streamlit.app/](https://customer-support-ai-agent-k4vwnntjzdtznlgtrhoyxs.streamlit.app/)  
‚öôÔ∏è **Backend API (FastAPI Docs):** [https://web-production-b381e.up.railway.app/docs](https://web-production-b381e.up.railway.app/docs)

---

## üß† Features

‚úÖ **Multi-Stage Response System**
1. **FAQ Match** ‚Äì Answers directly from stored FAQs  
2. **AI Fallback** ‚Äì Uses a pre-trained model (`distilbert-base-uncased-distilled-squad`) for natural Q&A  
3. **Ticket Creation** ‚Äì Creates a support ticket when confidence is low  

‚úÖ **Lightweight Database**
- Uses SQLite (file-based, zero configuration)  
- Stores FAQs and tickets in `/data/support.db`

‚úÖ **Clean REST API**
- `/ask`, `/faqs`, `/tickets`, `/health` endpoints  
- JSON-based responses ready for integration with any frontend  

‚úÖ **Streamlit Frontend (Optional)**
- Interactive chat-style UI with history  
- Sidebar for managing tickets and settings  
- Light or dark theme adaptive  

---

## üß∞ Tech Stack

| Layer | Technology |
|-------|-------------|
| **Backend** | FastAPI |
| **Database** | SQLite + SQLAlchemy ORM |
| **AI Model** | Hugging Face Transformers (`distilbert-base-uncased-distilled-squad`) |
| **Frontend (optional)** | Streamlit |
| **Language** | Python 3.9+ |

---

## üìÇ Project Structure

```text
customer-support-ai/
‚îú‚îÄ app/
‚îÇ  ‚îú‚îÄ main.py              # FastAPI app (core logic)
‚îÇ  ‚îú‚îÄ db.py                # SQLite engine and session
‚îÇ  ‚îú‚îÄ models.py            # ORM models: FAQ, Ticket
‚îÇ  ‚îú‚îÄ schemas.py           # Pydantic request/response models
‚îÇ  ‚îú‚îÄ faq_matcher.py       # Keyword/fuzzy-based FAQ matcher
‚îÇ  ‚îú‚îÄ ai.py                # Hugging Face QA model wrapper
‚îÇ  ‚îî‚îÄ seed_data.py         # Script to seed initial FAQs
‚îÇ
‚îú‚îÄ frontend/
‚îÇ  ‚îú‚îÄ streamlit_app.py     # Optional: interactive UI
‚îÇ  ‚îú‚îÄ index.html           # Optional HTML interface
‚îÇ  ‚îî‚îÄ assets/
‚îÇ     ‚îî‚îÄ styles.css
‚îÇ
‚îú‚îÄ data/
‚îÇ  ‚îî‚îÄ support.db           # SQLite database (auto-created)
‚îÇ
‚îú‚îÄ requirements.txt
‚îú‚îÄ .env.example
‚îî‚îÄ README.md
```

---

## üöÄ Quick Start

### 1Ô∏è‚É£ Install dependencies
```bash
pip install -r requirements.txt
```

### 2Ô∏è‚É£ Initialize database with sample FAQs
```bash
python -m app.seed_data
```

### 3Ô∏è‚É£ Run the FastAPI backend
```bash
uvicorn app.main:app --reload --port 8000
```

Access docs ‚Üí [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

### 4Ô∏è‚É£ (Optional) Launch Streamlit frontend
```bash
streamlit run frontend/streamlit_app.py
```

> üí° Set `BASE_URL` in the sidebar to your backend URL (e.g., `http://localhost:8000` or your Railway deployment URL).

---

## üåê REST API Endpoints

| Endpoint | Method | Description |
|-----------|---------|-------------|
| `/health` | GET | Check service health |
| `/ask` | POST | Ask a question (auto-decides between FAQ, AI, or Ticket) |
| `/faqs` | GET / POST | View or add FAQs |
| `/tickets` | GET / POST | List or create tickets |
| `/tickets/{id}` | GET | Retrieve a single ticket |

**Example Request**
```bash
POST /ask
{
  "question": "How long does shipping take?"
}
```

**Example Response**
```json
{
  "answer": "Orders are usually shipped within 2‚Äì3 business days.",
  "source": "faq",
  "score": 0.78,
  "ticket_id": null
}
```

---

## ‚öôÔ∏è Environment Variables (.env)

| Variable | Default | Description |
|-----------|----------|-------------|
| `MODEL_NAME` | `distilbert-base-uncased-distilled-squad` | Hugging Face model |
| `AI_CONFIDENCE_THRESHOLD` | `0.5` | Minimum AI confidence |
| `FAQ_STRICT_THRESHOLD` | `0.65` | Min score for FAQ match |
| `TOPK_FOR_AI` | `3` | Number of FAQs used to build context |

---

## üß© How It Works

1. **User asks a question** ‚Üí `/ask` endpoint receives it.  
2. **FAQ Matcher** computes fuzzy + keyword overlap score.  
3. If FAQ confidence > threshold ‚Üí returns FAQ answer.  
4. Else ‚Üí **AI model** (`distilbert`) tries to find the best answer from FAQ context.  
5. If AI confidence < threshold ‚Üí creates a **support ticket** automatically.

> This ensures users always get *some response* ‚Äî either a real answer or a ticket for human follow-up.

---

## üé® Streamlit Interface Highlights

- Chat interface with alternating user & bot messages  
- Sidebar with:
  - API URL settings  
  - Open tickets (auto-refresh)  
  - Manual ticket creation  
- Theme automatically adapts (light or dark)  
- Green accents for a "support" aesthetic  

---

## ‚òÅÔ∏è Deployment

### Backend (FastAPI)
- **Live:** [https://web-production-b381e.up.railway.app/docs](https://web-production-b381e.up.railway.app/docs)
- Deploy via [Render](https://render.com/) or [Railway](https://railway.app/):
  ```bash
  uvicorn app.main:app --host 0.0.0.0 --port 8000
  ```

### Frontend (Streamlit)
- **Live:** [https://customer-support-ai-agent-k4vwnntjzdtznlgtrhoyxs.streamlit.app/](https://customer-support-ai-agent-k4vwnntjzdtznlgtrhoyxs.streamlit.app/)
- Deploy separately on [Streamlit Cloud](https://streamlit.io/cloud).  
- Set the `BASE_URL` in the sidebar to your backend endpoint.

---

## üí° Professional Learning Takeaways

- **FastAPI + AI Integration:** Building REST APIs with NLP capability.  
- **Transformer Models:** Using pre-trained QA models for contextual understanding.  
- **Database Design:** Managing persistent data (FAQs & tickets) via SQLAlchemy.  
- **Error Handling:** Graceful fallbacks from AI to human support.  
- **Frontend Communication:** Streamlit-to-FastAPI real-time interactions.  
- **Full-Stack Deployment:** Multi-service deployment via Render + Streamlit Cloud.

